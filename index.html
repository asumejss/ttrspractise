<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Times Tables Trainer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #222;
      color: white;
      text-align: center;
      padding: 20px;
    }
    .hidden { display: none; }
    #question, #options, #score, #timer {
      margin: 20px 0;
      font-size: 1.5rem;
    }
    #options button {
      padding: 10px;
      margin: 10px;
      font-size: 1.2rem;
    }
    #gameOverScreen {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: red;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 4rem;
      font-weight: bold;
      z-index: 1000;
    }
  </style>
</head>
<body>

  <h1>Times Tables Trainer</h1>

  <!-- Authentication Section -->
  <div id="authSection">
    <input type="text" id="email" placeholder="Email" />
    <input type="password" id="password" placeholder="Password" />
    <br />
    <button onclick="signUp()">Sign Up</button>
    <button onclick="login()">Login</button>
    <button onclick="logout()">Logout</button>
  </div>

  <!-- Game Controls -->
  <div id="gameControls" class="hidden">
    <label for="timeSelect">Select Time:</label>
    <select id="timeSelect">
      <option value="1">1 Minute</option>
      <option value="2">2 Minutes</option>
      <option value="3">3 Minutes</option>
      <option value="4">4 Minutes</option>
      <option value="5">5 Minutes</option>
    </select>
    <button onclick="startGame()">Play</button>
    <button onclick="showStats()">My Stats</button>
  </div>

  <!-- Game Display -->
  <div id="timer"></div>
  <div id="question"></div>
  <div id="options"></div>
  <div id="score"></div>

  <div id="result"></div>
  <div id="gameOverScreen">Game Over</div>
  <div id="userStats" class="hidden"></div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID",
      measurementId: "YOUR_MEASUREMENT_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    let user = null;

    auth.onAuthStateChanged((u) => {
      user = u;
      document.getElementById("gameControls").classList.toggle("hidden", !user);
    });

    function signUp() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      auth.createUserWithEmailAndPassword(email, password)
        .then(() => alert("Signed Up"))
        .catch(err => alert(err.message));
    }

    function login() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      auth.signInWithEmailAndPassword(email, password)
        .then(() => alert("Logged In"))
        .catch(err => alert(err.message));
    }

    function logout() {
      auth.signOut();
    }

    // Game Logic
    const tables = [3, 4, 6, 7, 8, 9, 11, 12];
    let score = 0, totalQuestions = 0, timeLeft = 0, timerInterval, startTime;

    function getRandomQuestion() {
      const a = tables[Math.floor(Math.random() * tables.length)];
      const b = Math.floor(Math.random() * 12) + 1;
      return { a, b, answer: a * b };
    }

    function startGame() {
      score = 0;
      totalQuestions = 0;
      document.getElementById("score").textContent = "Score: 0";
      const minutes = parseInt(document.getElementById("timeSelect").value);
      timeLeft = minutes * 60;
      startTime = Date.now();
      document.getElementById("gameOverScreen").style.display = "none";
      displayQuestion();
      updateTimer();
      clearInterval(timerInterval);
      timerInterval = setInterval(() => {
        timeLeft--;
        updateTimer();
        if (timeLeft <= 0) endGame();
      }, 1000);
    }

    function updateTimer() {
      const m = Math.floor(timeLeft / 60);
      const s = timeLeft % 60;
      document.getElementById("timer").textContent = `Time: ${m}:${s.toString().padStart(2, "0")}`;
    }

    function displayQuestion() {
      const q = getRandomQuestion();
      document.getElementById("question").textContent = `${q.a} Ã— ${q.b} = ?`;
      const opts = generateOptions(q.answer);
      const optsEl = document.getElementById("options");
      optsEl.innerHTML = "";
      opts.forEach(opt => {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.onclick = () => {
          totalQuestions++;
          if (opt === q.answer) {
            score++;
            document.getElementBy 
